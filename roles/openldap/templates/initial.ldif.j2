# Ansible Managed: {{ ansible_managed }}
#
# Base structure and Admin user for OpenLDAP database
# This file is loaded using 'slapadd' during initialization.

# Top-level entry for the domain
dn: {{ ldap_base_dn }}
objectClass: top
objectClass: dcObject
objectClass: organization
o: {{ ldap_organization }}
# Use first component of domain (e.g., 'linkiafp' from 'linkiafp.es')
dc: {{ ldap_domain_components[0] }}

# LDAP Administrator Entry (matches rootdn in slapd.conf)
dn: {{ ldap_root_dn }}
# Use objectClasses appropriate for an administrative role
# organizationalRole is common, simpleSecurityObject holds the password
objectClass: organizationalRole
objectClass: simpleSecurityObject
cn: {{ ldap_root_user }}
description: LDAP Administrator
# Password hash generated by Ansible during playbook run
userPassword: {{ ldap_admin_password_hash }}

# Standard Organizational Units (OUs)
dn: ou=People,{{ ldap_base_dn }}
objectClass: organizationalUnit
ou: People

dn: ou=Groups,{{ ldap_base_dn }}
objectClass: organizationalUnit
ou: Groups

dn: ou=Services,{{ ldap_base_dn }}
objectClass: organizationalUnit
ou: Services

# Add other base OUs if needed, e.g., ou=Computers, ou=Sudoers
# dn: ou=Sudoers,{{ ldap_base_dn }}
# objectClass: organizationalUnit
# ou: Sudoers